# UFW Firewall Rules Template
# Generated by Ubuntu Server Setup Script

# Default policies
DEFAULT_INPUT_POLICY="DROP"
DEFAULT_OUTPUT_POLICY="ACCEPT"
DEFAULT_FORWARD_POLICY="DROP"

# Allow SSH
ufw allow 22/tcp comment 'SSH'

# Allow HTTP and HTTPS
ufw allow 80/tcp comment 'HTTP'
ufw allow 443/tcp comment 'HTTPS'

# Allow DNS
ufw allow 53/tcp comment 'DNS TCP'
ufw allow 53/udp comment 'DNS UDP'

# Allow NTP
ufw allow 123/udp comment 'NTP'

# Allow SMTP (if running mail server)
# ufw allow 25/tcp comment 'SMTP'
# ufw allow 587/tcp comment 'SMTP Submission'

# Allow IMAP/POP3 (if running mail server)
# ufw allow 143/tcp comment 'IMAP'
# ufw allow 993/tcp comment 'IMAPS'
# ufw allow 110/tcp comment 'POP3'
# ufw allow 995/tcp comment 'POP3S'

# Allow MySQL (if running database server)
# ufw allow 3306/tcp comment 'MySQL'

# Allow PostgreSQL (if running database server)
# ufw allow 5432/tcp comment 'PostgreSQL'

# Allow Redis (if running cache server)
# ufw allow 6379/tcp comment 'Redis'

# Allow MongoDB (if running NoSQL database)
# ufw allow 27017/tcp comment 'MongoDB'

# Allow Docker (if running containers)
# ufw allow 2375/tcp comment 'Docker API'
# ufw allow 2376/tcp comment 'Docker API TLS'

# Allow monitoring ports
# ufw allow 9090/tcp comment 'Prometheus'
# ufw allow 9100/tcp comment 'Node Exporter'
# ufw allow 19999/tcp comment 'Netdata'

# Rate limiting for SSH
ufw limit 22/tcp comment 'SSH Rate Limit'

# Logging
ufw logging on 